{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\risk-report-final-complete-final\\\\client\\\\src\\\\components\\\\InputPanel.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function InputPanel() {\n  _s();\n  const [hazard, setHazard] = useState('');\n  const [risk, setRisk] = useState('');\n  const [report, setReport] = useState('');\n  const [detailedReport, setDetailedReport] = useState('');\n  const [transcriptText, setTranscriptText] = useState('');\n  const recognitionRef = useRef(null);\n  const handleSubmit = async () => {\n    const response = await fetch('http://localhost:5000/api/report', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        hazard,\n        risk\n      })\n    });\n    const data = await response.json();\n    setReport(data.result);\n    setDetailedReport('');\n  };\n  const handleDetailedReport = async () => {\n    const prompt = `あなたは日本の労働安全衛生の専門家です。「${hazard}」という作業環境において「${risk}」の危険があると仮定し、これに対する改善提案を500文字程度で具体的かつ実用的に詳しく述べてください。フォーマルな話し言葉で、語尾は「〜をおすすめします」「〜が望まれます」などで締めてください。また、以下の5つのカテゴリに分類して出力してください：（0）法的要求事項（1）本質的対策（2）工学的対策（3）管理的対策（4）保護具の使用。該当がない場合は「なし」としてください。`;\n    const response = await fetch('http://localhost:5000/api/report', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        hazard,\n        risk,\n        prompt\n      })\n    });\n    const data = await response.json();\n    setDetailedReport(data.result);\n  };\n  useEffect(() => {\n    if (!('webkitSpeechRecognition' in window)) return;\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'ja-JP';\n    recognition.interimResults = false;\n    recognition.maxAlternatives = 1;\n    recognitionRef.current = recognition;\n  }, []);\n  const handleVoiceInput = type => {\n    const recognition = recognitionRef.current;\n    if (!recognition) return;\n    try {\n      recognition.start();\n    } catch (error) {\n      if (error.name === 'InvalidStateError') {\n        recognition.stop();\n        recognition.start();\n      } else {\n        console.error(\"音声認識エラー:\", error);\n      }\n    }\n    recognition.onresult = event => {\n      const transcript = event.results[0][0].transcript;\n      setTranscriptText(`認識結果（${type === 'hazard' ? '洗い出し' : '危険状況'}）：${transcript}`);\n      if (type === 'hazard') setHazard(transcript);\n      if (type === 'risk') setRisk(transcript);\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u52B4\\u707D\\u30EA\\u30B9\\u30AF\\u5831\\u544A\\u66F8\\u30C4\\u30FC\\u30EB\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"\\u6D17\\u3044\\u51FA\\u3057\\u5185\\u5BB9\\uFF1A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 29\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: hazard,\n      onChange: e => setHazard(e.target.value),\n      placeholder: \"\\u76F4\\u63A5\\u5165\\u529B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleVoiceInput('hazard'),\n      children: \"\\uD83C\\uDFA4 \\u8A71\\u3059\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"\\u5371\\u967A\\u72B6\\u6CC1\\uFF1A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: risk,\n      onChange: e => setRisk(e.target.value),\n      placeholder: \"\\u76F4\\u63A5\\u5165\\u529B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleVoiceInput('risk'),\n      children: \"\\uD83C\\uDFA4 \\u8A71\\u3059\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      children: \"\\u5831\\u544A\\u66F8\\u3092\\u4F5C\\u6210\\u3059\\u308B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), report && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"pre\", {\n        style: {\n          whiteSpace: 'pre-wrap'\n        },\n        children: report\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleDetailedReport,\n        children: \"\\u2463 \\u6539\\u5584\\u63D0\\u6848\\uFF08\\u8A73\\u7D30\\u7248\\uFF09\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), detailedReport && /*#__PURE__*/_jsxDEV(\"pre\", {\n      style: {\n        whiteSpace: 'pre-wrap',\n        color: 'darkblue'\n      },\n      children: detailedReport\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 26\n    }, this), transcriptText && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: transcriptText\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 26\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(InputPanel, \"FVEQ46zatg5yIylF0AS+DVp8tw0=\");\n_c = InputPanel;\nvar _c;\n$RefreshReg$(_c, \"InputPanel\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","Fragment","_Fragment","InputPanel","_s","hazard","setHazard","risk","setRisk","report","setReport","detailedReport","setDetailedReport","transcriptText","setTranscriptText","recognitionRef","handleSubmit","response","fetch","method","headers","body","JSON","stringify","data","json","result","handleDetailedReport","prompt","window","recognition","webkitSpeechRecognition","lang","interimResults","maxAlternatives","current","handleVoiceInput","type","start","error","name","stop","console","onresult","event","transcript","results","children","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","e","target","placeholder","onClick","style","whiteSpace","color","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/risk-report-final-complete-final/client/src/components/InputPanel.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\n\nexport default function InputPanel() {\n  const [hazard, setHazard] = useState('');\n  const [risk, setRisk] = useState('');\n  const [report, setReport] = useState('');\n  const [detailedReport, setDetailedReport] = useState('');\n  const [transcriptText, setTranscriptText] = useState('');\n  const recognitionRef = useRef(null);\n\n  const handleSubmit = async () => {\n    const response = await fetch('http://localhost:5000/api/report', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ hazard, risk })\n    });\n    const data = await response.json();\n    setReport(data.result);\n    setDetailedReport('');\n  };\n\n  const handleDetailedReport = async () => {\n    const prompt = `あなたは日本の労働安全衛生の専門家です。「${hazard}」という作業環境において「${risk}」の危険があると仮定し、これに対する改善提案を500文字程度で具体的かつ実用的に詳しく述べてください。フォーマルな話し言葉で、語尾は「〜をおすすめします」「〜が望まれます」などで締めてください。また、以下の5つのカテゴリに分類して出力してください：（0）法的要求事項（1）本質的対策（2）工学的対策（3）管理的対策（4）保護具の使用。該当がない場合は「なし」としてください。`;\n    const response = await fetch('http://localhost:5000/api/report', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ hazard, risk, prompt })\n    });\n    const data = await response.json();\n    setDetailedReport(data.result);\n  };\n\n  useEffect(() => {\n    if (!('webkitSpeechRecognition' in window)) return;\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'ja-JP';\n    recognition.interimResults = false;\n    recognition.maxAlternatives = 1;\n    recognitionRef.current = recognition;\n  }, []);\n\n  const handleVoiceInput = (type) => {\n    const recognition = recognitionRef.current;\n    if (!recognition) return;\n    try {\n      recognition.start();\n    } catch (error) {\n      if (error.name === 'InvalidStateError') {\n        recognition.stop();\n        recognition.start();\n      } else {\n        console.error(\"音声認識エラー:\", error);\n      }\n    }\n    recognition.onresult = (event) => {\n      const transcript = event.results[0][0].transcript;\n      setTranscriptText(`認識結果（${type === 'hazard' ? '洗い出し' : '危険状況'}）：${transcript}`);\n      if (type === 'hazard') setHazard(transcript);\n      if (type === 'risk') setRisk(transcript);\n    };\n  };\n\n  return (\n    <div>\n      <h2>労災リスク報告書ツール</h2>\n      <label>洗い出し内容：</label><br />\n      <input type=\"text\" value={hazard} onChange={e => setHazard(e.target.value)} placeholder=\"直接入力\" />\n      <button onClick={() => handleVoiceInput('hazard')}>🎤 話す</button>\n      <br /><br />\n\n      <label>危険状況：</label><br />\n      <input type=\"text\" value={risk} onChange={e => setRisk(e.target.value)} placeholder=\"直接入力\" />\n      <button onClick={() => handleVoiceInput('risk')}>🎤 話す</button>\n      <br /><br />\n\n      <button onClick={handleSubmit}>報告書を作成する</button>\n      {report && (\n        <>\n          <pre style={{ whiteSpace: 'pre-wrap' }}>{report}</pre>\n          <button onClick={handleDetailedReport}>④ 改善提案（詳細版）</button>\n        </>\n      )}\n      {detailedReport && <pre style={{ whiteSpace: 'pre-wrap', color: 'darkblue' }}>{detailedReport}</pre>}\n      {transcriptText && <p>{transcriptText}</p>}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}